Reads quality was assessed with FastQC v0.11.5 (https://www.bioinformatics.babraham.ac.uk/projects/fastqc/). Raw reads were filtered using Cutadapt v1.13 (Bolger et al. 2014) for sequencing adapters removal and quality trimming (minimum quality ≥ 28 and minimum length ≥ 25-bp). Only surviving paired-end reads were retained. Filtered reads were mapped to the multi-tissue reference transcriptome of Pinctada margaritifera (41,075 contigs) (Le Luyer et al. 2018) using bwa v0.7.15 (Li et al. 2009) with standard parameters. Low mapping quality and multi-mapping were removed using Samtools v1.4.1 (Li et al. 2009) with parameters -F 4 -F 256 -q 5 -f 2. A matrix of raw counts was built using HTSeq-count v0.6.1 (nders et al. 2015)
Differential analysis was then performed using DESeq2 version 1.16.2 (Love et al. 2014) with R version 3.4.0 (https://www.R-project.org/) following the standard workflow. The DESeq2 method internally corrects for library size and uses negative binomial generalized linear models to test for differential expression. In this study the statistical model was built using '~Color' design formula, where Color qualitative variable indicates oyster flesh color. All genes with a log2 fold change greater than 2 and a Benjamini-Hochberg adjusted p-value smaller than 0.01 were reported as differentially expressed.
